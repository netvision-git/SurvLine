using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using static System.Windows.Forms.VisualStyles.VisualStyleElement.Window;

namespace SurvLine
{
    internal class CtrlValue
    {
        //==========================================================================================
        /*[VB]
        '*******************************************************************************
        '値コントロール
        '
        'Value プロパティの操作。

        Option Explicit
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        //==========================================================================================

        //==========================================================================================
        /*[VB]
        'プロパティ
        Public Value As Variant '値。
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        //'プロパティ
        public bool Value;          //'値。
        //==========================================================================================

        //==========================================================================================
        /*[VB]
        'インプリメンテーション
        Private m_clsObject As CtrlValue 'オブジェクト。
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        //'インプリメンテーション
        private CtrlValue m_clsObject;  //'オブジェクト。
        //==========================================================================================

        //==========================================================================================
        /*[VB]
        '*******************************************************************************
        'イベント

        '値を元に戻す。
        Private Sub Class_Terminate()
            Call Back
        End Sub
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        /*
        '*******************************************************************************
        'イベント

        '値を元に戻す。
        */
        private void Class_Terminate()
        {
            Back();
        }
        //==========================================================================================

        //==========================================================================================
        /*[VB]
        '*******************************************************************************
        'メソッド

        '設定。
        '
        '引き数：
        'clsObject 対象オブジェクト。
        'vValue 値。
        Public Sub SetObject(ByVal clsObject As CtrlValue, ByVal vValue As Variant)
            Set m_clsObject = clsObject
            Value = m_clsObject.Value
            m_clsObject.Value = vValue
        End Sub
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        /*
        '*******************************************************************************
        'メソッド

        '設定。
        '
        '引き数：
        'clsObject 対象オブジェクト。
        'vValue 値。
        */
        public void SetObject(CtrlValue clsObject, bool vValue)
        {
            m_clsObject = clsObject;
            Value = m_clsObject.Value;
            m_clsObject.Value = vValue;
        }
        //==========================================================================================

        //==========================================================================================
        /*[VB]
        '値を元に戻す。
        Public Sub Back()
            If Not m_clsObject Is Nothing Then
                m_clsObject.Value = Value
                Set m_clsObject = Nothing
            End If
        End Sub
        [VB]*/
        //------------------------------------------------------------------------------------------
        //[C#]
        //'値を元に戻す。
        public void Back()
        {
            if (m_clsObject != null)
            {
                m_clsObject.Value = Value;
                m_clsObject = null;
            }
        }
        //==========================================================================================
    }
}
